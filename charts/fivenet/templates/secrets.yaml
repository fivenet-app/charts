apiVersion: v1
kind: Secret
metadata:
  name: "{{ include "fivenet.fullname" . }}-config"
data:
  config.yaml: {{ tpl (.Values.fivenet.config | toYaml) . | b64enc }}
{{- if .Values.migration.enabled -}}
---
apiVersion: v1
kind: Secret
metadata:
  name: "{{ include "fivenet.fullname" . }}-config-migration"
  annotations:
    helm.sh/hook: pre-install
    helm.sh/hook-delete-policy: before-hook-creation,hook-succeeded
    helm.sh/hook-weight: "-10"
data:
  config.yaml: {{ tpl (.Values.fivenet.config | toYaml) . | b64enc }}
{{- end -}}
